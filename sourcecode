data <- #ch√®n data t·ª´ file excel, csv . . . n√™n ƒë·ªÉ d·∫°ng long data tr∆∞·ªõc n·∫øu kh√¥ng th√™m b∆∞·ªõc ch·ªânh v·ªÅ long data


setup_packages <- function() {
  packages <- c("tidyverse", "car", "dunn.test", "ggplot2", 
                "gridExtra", "knitr", "rmarkdown")
  
  for (pkg in packages) {
    if (!require(pkg, character.only = TRUE, quietly = TRUE)) {
      install.packages(pkg, dependencies = TRUE)
      library(pkg, character.only = TRUE)
    }
  }
  
  cat("‚úì ƒê√£ load t·∫•t c·∫£ packages c·∫ßn thi·∫øt\n\n")
}

setup_packages()


auto_analyze <- function(data, 
                         group_col = "CMC",                        #Thay th·∫ø Conc b·∫±ng t√™n kh√°c mi·ªÖn l√† bi·∫øn ko ph·ª• thu·ªôc
                         output_dir = "analysis_results",
                         save_plots = TRUE,
                         save_report = TRUE) {
 
  cat("‚ïë  PIPELINE PH√ÇN T√çCH D·ªÆ LI·ªÜU   ‚ïë\n")

  if (!dir.exists(output_dir)) {
    dir.create(output_dir, recursive = TRUE)
  }
  

cat("  - S·ªë d√≤ng:", nrow(data), "\n")
cat("  - S·ªë c·ªôt:", ncol(data), "\n")
cat("  - T√™n c·ªôt:", paste(names(data), collapse = ", "), "\n\n")
  
  # X√°c ƒë·ªãnh c·ªôt nh√≥m v√† c√°c bi·∫øn ph·ª• thu·ªôc
  if (!group_col %in% names(data)) {
    stop(paste("‚ùå Kh√¥ng t√¨m th·∫•y c·ªôt nh√≥m:", group_col))
  }
  
  dependent_vars <- setdiff(names(data), group_col)
  cat("‚úì C·ªôt nh√≥m:", group_col, "\n")
  cat("‚úì Bi·∫øn ph·ª• thu·ªôc:", paste(dependent_vars, collapse = ", "), "\n\n")
  
  # T·∫°o danh s√°ch l∆∞u k·∫øt qu·∫£
  results <- list(
    data = data,
    group_col = group_col,
    dependent_vars = dependent_vars,
    warnings = list(),
    statistics = list(),
    plots = list()
  )

print(results)

  cat("\nüîç B∆Ø·ªöC 2: KI·ªÇM TRA CH·∫§T L∆Ø·ª¢NG D·ªÆ LI·ªÜU\n")
  cat("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n")
  
  for (var in dependent_vars) {
    cat("\nüìä Bi·∫øn:", var, "\n")
    
    # C·∫•u tr√∫c d·ªØ li·ªáu
    structure_check <- data %>%
      group_by(!!sym(group_col)) %>%
      summarise(
        n = n(),
        unique_values = length(unique(!!sym(var))),
        all_identical = length(unique(!!sym(var))) == 1,
        has_missing = any(is.na(!!sym(var))),
        mean = mean(!!sym(var), na.rm = TRUE),
        sd = sd(!!sym(var), na.rm = TRUE),
        cv_percent = (sd / mean) * 100,
        min = min(!!sym(var), na.rm = TRUE),
        max = max(!!sym(var), na.rm = TRUE),
        .groups = 'drop'
      )

    
print(structure_check)

warnings <- c()

if (any(structure_check$n < 3)) {
  groups <- structure_check[[group_col]][structure_check$n < 3]
  warnings <- c(warnings, 
                paste("‚ö†Ô∏è Nh√≥m", paste(groups, collapse=", "), "c√≥ n < 3"))
}

if (any(structure_check$all_identical, na.rm = TRUE)) {
  groups <- structure_check[[group_col]][structure_check$all_identical]
  warnings <- c(warnings,
                paste("‚ö†Ô∏è Nh√≥m", paste(groups, collapse=", "), "c√≥ gi√° tr·ªã gi·ªëng nhau"))
}

if (any(structure_check$cv_percent > 20, na.rm = TRUE)) {
  groups <- structure_check[[group_col]][structure_check$cv_percent > 20]
  warnings <- c(warnings,
                paste("‚ö†Ô∏è Nh√≥m", paste(groups, collapse=", "), "c√≥ CV > 20% bi·∫øn thi√™n cao"))
}

if (any(structure_check$has_missing)) {
  groups <- structure_check[[group_col]][structure_check$has_missing]
  warnings <- c(warnings,
                paste("‚ö†Ô∏è Nh√≥m", paste(groups, collapse=", "), "c√≥ missing data"))
}

# In c·∫£nh b√°o
if (length(warnings) > 0) {
  cat("\nüö® C·∫¢NH B√ÅO:\n")
  for (w in warnings) cat("  ", w, "\n")
  results$warnings[[var]] <- warnings
} else {
  cat("\n‚úì Kh√¥ng c√≥ v·∫•n ƒë·ªÅ nghi√™m tr·ªçng\n")
}

results$statistics[[var]]$structure <- structure_check
  }
  
  cat("\n\nüîé B∆Ø·ªöC 3: PH√ÅT HI·ªÜN OUTLIERS\n")
  cat("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n")
  
  for (var in dependent_vars) {
    cat("\nüìä Bi·∫øn:", var, "\n")
    
    outliers_info <- list()
    total_outliers <- 0
    
    for (grp in unique(data[[group_col]])) {
      values <- data[[var]][data[[group_col]] == grp & !is.na(data[[var]])]
      
      if (length(values) < 3) next
      
      Q1 <- quantile(values, 0.25)
      Q3 <- quantile(values, 0.75)
      IQR_val <- Q3 - Q1
      
      lower <- Q1 - 1.5 * IQR_val
      upper <- Q3 + 1.5 * IQR_val
      
      outliers <- values[values < lower | values > upper]
      
      if (length(outliers) > 0) {
        cat("  Nh√≥m", grp, ": C√≥", length(outliers), "outlier(s) -",
            round(outliers, 2), "\n")
        outliers_info[[as.character(grp)]] <- outliers
        total_outliers <- total_outliers + length(outliers)
      }
    }
    
    if (total_outliers == 0) {
      cat("‚úì Kh√¥ng ph√°t hi·ªán outliers\n")
    } else {
      cat("\n‚ö†Ô∏è T·ªïng c·ªông:", total_outliers, "outliers\n")
    }
    
    results$statistics[[var]]$outliers <- outliers_info
  }
  
  # ========================================================================
  # B∆Ø·ªöC 4: KI·ªÇM TRA GI·∫¢ ƒê·ªäNH
  # ========================================================================
  
  cat("\n\nüìã B∆Ø·ªöC 4: KI·ªÇM TRA GI·∫¢ ƒê·ªäNH TH·ªêNG K√ä\n")
  cat("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n")
  
  for (var in dependent_vars) {
    cat("\nüìä Bi·∫øn:", var, "\n\n")
    
    # 4.1 Ki·ªÉm tra ph√¢n ph·ªëi chu·∫©n
    cat("  [1] Shapiro-Wilk test (Ph√¢n ph·ªëi chu·∫©n):\n")
    
    normality_results <- data.frame()
    
    for (grp in unique(data[[group_col]])) {
      values <- data[[var]][data[[group_col]] == grp & !is.na(data[[var]])]
      
      if (length(values) >= 3 && length(unique(values)) > 1 && sd(values) > 0) {
        test <- tryCatch(
          shapiro.test(values),
          error = function(e) list(statistic = NA, p.value = NA)
        )
        
        normality_results <- rbind(
          normality_results,
          data.frame(
            Group = grp,
            n = length(values),
            W = round(test$statistic, 4),
            p_value = round(test$p.value, 4),
            Normal = ifelse(test$p.value > 0.05, "‚úì Chu·∫©n", "‚úó Kh√¥ng chu·∫©n")
          )
        )
      }
    }
    
    print(normality_results)
    
    non_normal_count <- sum(normality_results$p_value < 0.05, na.rm = TRUE)
    
    if (non_normal_count > 0) {
      cat("\n  ‚ö†Ô∏è C√≥", non_normal_count, "nh√≥m kh√¥ng ph√¢n ph·ªëi chu·∫©n\n")
      cat("  ‚Üí Khuy·∫øn ngh·ªã: Kruskal-Wallis test\n")
    } else {
      cat("\n  ‚úì T·∫•t c·∫£ nh√≥m ph√¢n ph·ªëi chu·∫©n\n")
    }
    
    results$statistics[[var]]$normality <- normality_results
    
    # Ki·ªÉm tra ph∆∞∆°ng sai ƒë·ªìng nh·∫•t
    cat("\n  [2] Levene's test (Ph∆∞∆°ng sai ƒë·ªìng nh·∫•t):\n")
    
    formula_str <- as.formula(paste(var, "~ factor(", group_col, ")"))
    levene_result <- leveneTest(formula_str, data = data)
    print(levene_result)
    
    levene_p <- levene_result$`Pr(>F)`[1]
    
    if (levene_p > 0.05) {
      cat("\n  ‚úì Ph∆∞∆°ng sai ƒë·ªìng nh·∫•t (p =", round(levene_p, 4), ")\n")
    } else {
      cat("\n  ‚ö†Ô∏è Ph∆∞∆°ng sai kh√¥ng ƒë·ªìng nh·∫•t (p =", round(levene_p, 4), ")\n")
      cat("  ‚Üí Khuy·∫øn ngh·ªã: Welch's ANOVA\n")
    }
    
    results$statistics[[var]]$levene <- levene_result
    results$statistics[[var]]$levene_p <- levene_p
    results$statistics[[var]]$non_normal_count <- non_normal_count
  }
  
  cat("\n\nüìä B∆Ø·ªöC 5: PH√ÇN T√çCH TH·ªêNG K√ä\n")
  cat("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n")
  
  for (var in dependent_vars) {
    cat("\n" , rep("‚ïê", 60), "\n", sep = "")
    cat("BI·∫æN:", var, "\n")
    cat(rep("‚ïê", 60), "\n\n", sep = "")
    
    non_normal <- results$statistics[[var]]$non_normal_count
    levene_p <- results$statistics[[var]]$levene_p
    

    if (non_normal > 0) {
      # KRUSKAL-WALLIS TEST
      cat("‚Üí Ph∆∞∆°ng ph√°p: Kruskal-Wallis test (d·ªØ li·ªáu kh√¥ng chu·∫©n)\n\n")
      
      kw_result <- kruskal.test(data[[var]] ~ factor(data[[group_col]]))
      print(kw_result)
      
      results$statistics[[var]]$test_used <- "Kruskal-Wallis"
      results$statistics[[var]]$main_result <- kw_result
      
      if (kw_result$p.value < 0.05) {
        cat("\n‚úÖ K·∫æT LU·∫¨N: C√≥ s·ª± kh√°c bi·ªát c√≥ √Ω nghƒ©a th·ªëng k√™ (p < 0.05)\n")
        cat("\n‚Üí Th·ª±c hi·ªán Dunn's post-hoc test:\n\n")
        
        dunn_result <- dunn.test(data[[var]], factor(data[[group_col]]),
                                 method = "bonferroni",
                                 list = TRUE,
                                 table = TRUE)
        
        results$statistics[[var]]$posthoc <- dunn_result
        results$statistics[[var]]$significant <- TRUE
        
      } else {
        cat("\n‚ùå K·∫æT LU·∫¨N: Kh√¥ng c√≥ s·ª± kh√°c bi·ªát c√≥ √Ω nghƒ©a (p ‚â• 0.05)\n")
        results$statistics[[var]]$significant <- FALSE
      }
      
    } else if (levene_p < 0.05) {
      # WELCH'S ANOVA
      cat("‚Üí Ph∆∞∆°ng ph√°p: Welch's ANOVA (ph∆∞∆°ng sai kh√¥ng ƒë·ªìng nh·∫•t)\n\n")
      
      formula_str <- as.formula(paste(var, "~ factor(", group_col, ")"))
      welch_result <- oneway.test(formula_str, data = data)
      print(welch_result)
      
      results$statistics[[var]]$test_used <- "Welch's ANOVA"
      results$statistics[[var]]$main_result <- welch_result
      
      if (welch_result$p.value < 0.05) {
        cat("\n‚úÖ K·∫æT LU·∫¨N: C√≥ s·ª± kh√°c bi·ªát c√≥ √Ω nghƒ©a th·ªëng k√™ (p < 0.05)\n")
        cat("\n‚Üí G·ª£i √Ω: S·ª≠ d·ª•ng Games-Howell post-hoc test\n")
        cat("   (C·∫ßn package 'rstatix')\n")
        results$statistics[[var]]$significant <- TRUE
      } else {
        cat("\n‚ùå K·∫æT LU·∫¨N: Kh√¥ng c√≥ s·ª± kh√°c bi·ªát c√≥ √Ω nghƒ©a (p ‚â• 0.05)\n")
        results$statistics[[var]]$significant <- FALSE
      }
      
    } else {
      # ONE-WAY ANOVA
      cat("‚Üí Ph∆∞∆°ng ph√°p: One-way ANOVA (ƒë√°p ·ª©ng ƒë·∫ßy ƒë·ªß gi·∫£ ƒë·ªãnh)\n\n")
      
      formula_str <- as.formula(paste(var, "~ factor(", group_col, ")"))
      anova_result <- aov(formula_str, data = data)
      print(summary(anova_result))
      
      results$statistics[[var]]$test_used <- "One-way ANOVA"
      results$statistics[[var]]$main_result <- anova_result
      
      anova_p <- summary(anova_result)[[1]][["Pr(>F)"]][1]
      
      if (anova_p < 0.05) {
        cat("\n‚úÖ K·∫æT LU·∫¨N: C√≥ s·ª± kh√°c bi·ªát c√≥ √Ω nghƒ©a th·ªëng k√™ (p < 0.05)\n")
        cat("\n‚Üí Th·ª±c hi·ªán Tukey HSD post-hoc test:\n\n")
        
        tukey_result <- TukeyHSD(anova_result)
        print(tukey_result)
        
        results$statistics[[var]]$posthoc <- tukey_result
        results$statistics[[var]]$significant <- TRUE
        
      } else {
        cat("\n‚ùå K·∫æT LU·∫¨N: Kh√¥ng c√≥ s·ª± kh√°c bi·ªát c√≥ √Ω nghƒ©a (p ‚â• 0.05)\n")
        results$statistics[[var]]$significant <- FALSE
      }
    }
    
    cat("\n")
  }
  
  if (save_plots) {
    cat("\nüìà B∆Ø·ªöC 6: T·∫†O BI·ªÇU ƒê·ªí\n")
    cat("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n")
    
    # Chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu sang long format
    data_long <- data %>%
      pivot_longer(cols = all_of(dependent_vars),
                   names_to = "Variable",
                   values_to = "Value")
    
    # Boxplot
    p1 <- ggplot(data_long, aes(x = factor(!!sym(group_col)), y = Value, 
                                fill = Variable)) +
      geom_boxplot(alpha = 0.7, outlier.color = "red", outlier.size = 2) +
      geom_jitter(width = 0.15, size = 1.5, alpha = 0.4) +
      facet_wrap(~Variable, scales = "free_y") +
      labs(title = "Ph√¢n b·ªë gi√° tr·ªã theo nh√≥m",
           x = group_col,
           y = "Gi√° tr·ªã") +
      theme_minimal() +
      theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
            legend.position = "none")
    
    results$plots$boxplot <- p1
    box1 <- results$plots$boxplot

    # Line plot v·ªõi error bars
    stats_plot <- data_long %>%
      group_by(!!sym(group_col), Variable) %>%
      summarise(
        Mean = mean(Value, na.rm = TRUE),
        SE = sd(Value, na.rm = TRUE) / sqrt(n()),
        .groups = 'drop'
      )
    
    p2 <- ggplot(stats_plot, aes(x = !!sym(group_col), y = Mean, 
                                 color = Variable, group = Variable)) +
      geom_line(linewidth = 1) +
      geom_point(size = 3) +
      geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE),
                    width = 0.2, size = 0.8) +
      labs(title = "Xu h∆∞·ªõng (Mean ¬± SE)",
           x = group_col,
           y = "Mean ¬± SE") +
      theme_minimal() +
      theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
            legend.position = "bottom")
    
    results$plots$lineplot <- p2
    line1 <- results$plots$lineplot
  }
  
  cat("\n\nüìã B∆Ø·ªöC 7: T·∫†O B√ÅO C√ÅO T√ìM T·∫ÆT\n")
  cat("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n")
  
  summary_text <- generate_summary(results)
  
  cat(summary_text)
  
  if (save_report) {
    report_file <- file.path(output_dir, "analysis_report.txt")
    writeLines(summary_text, report_file)
    cat("\n‚úì ƒê√£ l∆∞u b√°o c√°o v√†o:", report_file, "\n")
  }
  
  cat("üìä S·ªë bi·∫øn ph√¢n t√≠ch:", length(dependent_vars), "\n")
  cat("üî¢ T·ªïng s·ªë nh√≥m:", length(unique(data[[group_col]])), "\n\n")
  
  invisible(results)
}

generate_summary <- function(results) {
  lines <- c()
  
  lines <- c(lines, "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó")
  lines <- c(lines, "‚ïë              B√ÅO C√ÅO PH√ÇN T√çCH TH·ªêNG K√ä                    ‚ïë")
  lines <- c(lines, "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n")
  
  lines <- c(lines, paste("Ng√†y ph√¢n t√≠ch:", Sys.time()))
  lines <- c(lines, paste("S·ªë bi·∫øn:", length(results$dependent_vars)))
  lines <- c(lines, paste("Bi·∫øn ph√¢n t√≠ch:", paste(results$dependent_vars, collapse = ", ")))
  lines <- c(lines, paste("C·ªôt nh√≥m:", results$group_col))
  lines <- c(lines, paste("S·ªë nh√≥m:", length(unique(results$data[[results$group_col]]))))
  lines <- c(lines, paste("T·ªïng s·ªë m·∫´u:", nrow(results$data)))
  
  for (var in results$dependent_vars) {
    lines <- c(lines, rep("‚îÄ", 2))
    lines <- c(lines, paste("BI·∫æN:", var))
    lines <- c(lines, rep("‚îÄ", 2))

    if (!is.null(results$warnings[[var]]) && length(results$warnings[[var]]) > 0) {
      lines <- c(lines, "\nüö® C·∫¢NH B√ÅO:")
      for (w in results$warnings[[var]]) {
        lines <- c(lines, paste("  ", w))
      }
    }
    

    if (length(results$statistics[[var]]$outliers) > 0) {
      lines <- c(lines, paste("\n‚ö†Ô∏è Outliers:", 
                              sum(sapply(results$statistics[[var]]$outliers, length))))
    }
    
    lines <- c(lines, paste("\nüìä Ph∆∞∆°ng ph√°p:", 
                            results$statistics[[var]]$test_used))
  
    if (results$statistics[[var]]$significant) {
      lines <- c(lines, "‚úÖ K·∫øt lu·∫≠n: C√ì S·ª∞ KH√ÅC BI·ªÜT C√ì √ù NGHƒ®A TH·ªêNG K√ä")
    } else {
      lines <- c(lines, "‚ùå K·∫øt lu·∫≠n: KH√îNG C√ì S·ª∞ KH√ÅC BI·ªÜT C√ì √ù NGHƒ®A")
    }
    
    lines <- c(lines, "\n")
  }
  
  return(paste(lines, collapse = "\n"))
}

#Ch·∫°y ph√¢n t√≠ch data theo pipeline tr√™n
results <- auto_analyze(data)

#Hi·ªÉn th·ªã bi·ªÉu ƒë·ªì boxplot v√† lineplot
print(line1)

